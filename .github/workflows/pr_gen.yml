on:
  repository_dispatch:
    types: [manually_dispatched]

name: Generate PR for a requested manifest edit
jobs:
  generate:
    runs-on: ubuntu-22.04

    steps:
      - name: 📦 Checkout
        uses: actions/checkout@v3

      - name: 🌐 Fetch Edit
        env:
            EDIT_URL: ${{ github.event.client_payload.edit_url }}
        run: |
            rm ./manifest.json
            wget $EDIT_URL -O ./manifest.json
            
      - name: Set Branch Name
        id: branch_name_gen
        run: |
            echo "::set-output name=bname::$(date +%s)"
            
      - name: 🍴 Commit & Fork
        uses: EndBug/add-and-commit@v9.1.3
        with:
            default_author: github_actions
            new_branch: edit_${{ steps.branch_name_gen.outputs.bname }}